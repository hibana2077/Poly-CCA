下面把「要跑的實驗」與「可檢驗的預期結果」用條列清楚列出（全部可在單機 CPU 完成）。

# 指標與共用設定

* **資料集**：PolySimDNA（自建合成）、UCI Promoter、UCI Splice（可做小樣本子集）。
* **特徵**：k-mer $k\in\{2,3,4\}$，預設 $k=3$；多項式度 $d\in\{1,2\}$，預設 $d=2$。
* **方法**：

  * 我方：Poly-CCA（雙視角）／MG-TCCA（多群）。
  * 基線：k-mer+LR、k-mer+SVM、PCA→LR、LDA、(可選) 多項式特徵→LR（無 CCA）、核 SVM（RBF；做小子集避免失衡）。
* **評估**：Macro-F1、ROC-AUC、加雜訊穩健性曲線（對不同替換率 $p$）、top-1 canonical correlation $\rho_1$、跨雜訊落差 $\Delta=\text{F1}(p{=}0)-\text{F1}(p{>}0)$。

---

## 實驗與預期結果（條列）

1. **合成資料可識別性（Sanity Check）**

   * 做法：在 PolySimDNA 上以已知 motif 生成資料，設定 $p\in\{0,0.01,0.05,0.1\}$。
   * 預期：Poly-CCA/MG-TCCA 的 $\rho_1$ 在不同 $p$ 下維持高且緩降；分類 Macro-F1 明顯優於「無 CCA」基線；$\Delta$ 顯著較小。

2. **替換雜訊穩健性曲線**

   * 做法：固定訓練於 $p\in\{0,0.05\}$，測試於更高 $p$。
   * 預期：MG-TCCA > Poly-CCA > 無 CCA。MG-TCCA 對「訓練/測試雜訊不匹配」最穩；基線隨 $p$ 上升快速退化。

3. **插入/刪除（INDEL）外推檢驗**

   * 做法：在合成資料加入輕度 INDEL。
   * 預期：Poly-CCA 仍優於基線但幅度小於純替換雜訊；顯示模型對 INDEL 有「部分」魯棒，值得未來擴充特徵。

4. **多群學習的效益（MG-TCCA vs. Poly-CCA）**

   * 做法：把不同 $p$ 或不同背景 GC 比例視為群；比較 MG-TCCA 與單一 CCA。
   * 預期：MG-TCCA 在跨群測試上有明顯優勢；當群間差異越大，提升越顯著。

5. **多項式度數消融（$d=1$ vs. $d=2$）**

   * 做法：固定 $k=3$，比較一次/二次特徵。
   * 預期：若 motif 含「雙位點互動」或背景偏好，$d=2$ 帶來可觀提升；若為單位點訊號，$d=2$ 與 $d=1$ 接近（避免過度擬合證據）。

6. **k-mer 長度掃描（$k=2,3,4$）**

   * 做法：於三資料集交叉驗證。
   * 預期：$k=2$ 表現偏低（資訊不足），$k=4$ 在小樣本上易過擬合；**$k=3$ 最穩定**，整體最佳或接近最佳。

7. **樣本數曲線（小樣本優勢）**

   * 做法：逐步增加訓練樣本（如 10%、30%、50%、100%）。
   * 預期：在低樣本區間 Poly-CCA/MG-TCCA 相對基線的**相對提升最大**；樣本增多時差距縮小但仍不劣。

8. **跨資料集遷移**

   * 做法：在 PolySimDNA 訓練，於 Promoter/Splice 測試（或反向，用少量 target 調整）。
   * 預期：CCA 表示在目標域上需要極少量調整即可達到與直接訓練相近的表現；基線需較多調整。

9. **分類器無關性（下游模型換頭）**

   * 做法：在 CCA 子空間上比較 LR vs. 線性 SVM。
   * 預期：兩者表現接近，顯示**關鍵在表示**非分類器；若差異，SVM 在邊界較緊時微幅領先。

10. **可解釋性：motif 恢復**

    * 做法：把 canonical 向量映回 k-mer 權重，檢查與已知 motif 的重合（排名相關／富集分數）。
    * 預期：Poly-CCA 的 top-k k-mer 與真實 motif 顯著對齊；基線權重較分散。

11. **與核方法比較（小子集）**

    * 做法：在可控子集與 RBF-SVM 比較。
    * 預期：RBF-SVM 在無雜訊、資料充裕時可持平或略優，但**對雜訊與遷移較脆弱**；Poly-CCA 在跨 $p$ 穩健性與可解釋性上佔優。

12. **統計顯著性**

    * 做法：5×2 或 10×k CV，對 Macro-F1 做 corrected t-test / Wilcoxon。
    * 預期：Poly-CCA/MG-TCCA 對主要基線的提升在 Promoter 與 Splice 上達**統計顯著（p<0.05）**。

13. **計算量與資源檢核（CPU 友好）**

    * 做法：記錄特徵維度、記憶體峰值、矩陣尺寸與分解次數；比較核方法。
    * 預期：Poly-CCA 的矩陣尺寸受 $k,d$ 控制（數萬級以下），記憶體明顯低於核方法；可在單機 CPU 穩定完成。

14. **正則化與超參數敏感度**

    * 做法：掃描 CCA 正則（如 ridge）、特徵標準化方式。
    * 預期：在寬鬆區間內性能**平台期**明顯，顯示方法穩健；過強正則略降，過弱則在小樣本噪聲下不穩。

15. **真實資料雜訊擬合度**

    * 做法：對 Promoter/Splice 以資料增強模擬不同 $p$，檢驗與實測退化斜率差距。
    * 預期：以「收縮模型」預估的性能下降與實測趨勢一致，支持理論假設。

---

### 短結論（預期整體趨勢）

* 在**小樣本 + 雜訊**場景，Poly-CCA/MG-TCCA 對基線有**穩定且顯著**的 Macro-F1/ROC-AUC 提升，且**跨雜訊落差更小**。
* $k=3, d=2$ 為穩健且 CPU 友好的甜蜜點；MG-TCCA 在跨群/跨域更具優勢。
* 表示具有**可解釋性**（可回溯到 motif），且與「收縮理論」相吻合。